2026-01-13 12:15:44 [[32MINFO[39M]: Connected to MySQL Database
2026-01-13 12:15:44 [[32MINFO[39M]: Starting Phase 1: Redis Reservation
2026-01-13 12:15:44 [[32MINFO[39M]: Starting Phase 2: MySQL Transaction
2026-01-13 12:15:44 [[32MINFO[39M]: Rolling back Redis reservation...
  console.error
    Error: Cannot add or update a child row: a foreign key constraint fails (`ebazer_shop`.`orders`, CONSTRAINT `orders_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE)
        at PromisePoolConnection.query (D:\evanto\New folder (3)\ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc\backend\node_modules\mysql2\lib\promise\connection.js:29:22)
        at query (D:\evanto\New folder (3)\ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc\backend\controllers\orderController.js:192:44)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)

    [0m [90m 13 |[39m   })[33m;[39m
     [90m 14 |[39m
    [31m[1m>[22m[39m[90m 15 |[39m   console[33m.[39merror(err[33m.[39mstack)[33m;[39m [90m// Keep console logging for dev[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 16 |[39m
     [90m 17 |[39m   res[33m.[39mstatus(statusCode)[33m;[39m
     [90m 18 |[39m   res[33m.[39mjson({[0m

      at error (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/middleware/errorMiddleware.js:15:11)
      at Layer.handle_error (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/layer.js:71:5)
      at trim_prefix (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:326:13)
      at D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:286:9
      at Function.process_params (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:346:12)
      at next (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:280:10)
      at Layer.handle_error (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/layer.js:67:12)
      at trim_prefix (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:326:13)
      at D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:286:9
      at Function.process_params (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:346:12)
      at next (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:280:10)
      at D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:646:15
      at next (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/index.js:265:14)
      at next (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/express/lib/router/route.js:141:14)
      at next (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/controllers/orderController.js:223:5)

2026-01-13 12:15:44 [[33MWARN[39M]: POST /api/orders 500 - 115ms - IP: ::ffff:127.0.0.1
FAIL tests/integration/security_order.test.js
  Security: Secure Order Creation
    â”œÃ¹ should IGNORE client-provided price and use DB price (166 ms)

  Î“Ã¹Ã… Security: Secure Order Creation Î“Ã‡â•‘ should IGNORE client-provided price and use DB price

    expected 201 "Created", got 500 "Internal Server Error"

      71 |       .post('/api/orders')
      72 |       .send(payload)
    > 73 |       .expect(201);
         |        ^
      74 |
      75 |     // Verify Response Total
      76 |     const expectedTotal = realPrice * quantity; // 200.00

      at Object.expect (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/tests/integration/security_order.test.js:73:8)
      ----
      at Test._assertStatus (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/supertest/lib/test.js:309:14)
      at D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/supertest/lib/test.js:342:13)
      at Test.assert (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/supertest/lib/test.js:195:23)
      at localAssert (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (D:\evanto\New folder (3)../../../../ebazer-tailwind-css-ecommerce-admin-template-2025-05-05-05-21-50-utc/backend/node_modules/supertest/lib/test.js:152:11)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        3.522 s, estimated 7 s
Ran all test suites matching backend/tests/integration/security_order.test.js.
